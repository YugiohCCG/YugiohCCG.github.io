import{_ as j,j as a}from"./index-CW3kYlzI.js";import{b as p}from"./react-BJTGk-tB.js";import{a as C}from"./assets-BkOAQMwM.js";import{u as L,C as w}from"./CardTile-BUHjHFJP.js";let b=null,x=null;function h(t){const e=String(t||"").toLowerCase().trim();return e?e==="banned"||e==="forbidden"?{banned:!0}:e==="limited"||e==="limit"?{limited:!0}:e==="semi-limited"||e==="semilimited"||e==="semi"?{semiLimited:!0}:e==="unlimited"||e==="legal"?{}:null:null}function B(t,e){const n=new Map,u=new Map,m=e;if(t&&typeof t=="object"&&!Array.isArray(t))for(const[s,i]of Object.entries(t)){const c=i?.[m]??i?.status??(typeof i=="string"?i:void 0),r=h(c);if(!r)continue;const l=s.toUpperCase();/^[A-Z0-9\-_:]+$/.test(l)?n.set(l,r):u.set(l,r)}if(Array.isArray(t))for(const s of t){const i=(s?.id??s?.code??s?.name)?.toString(),c=s?.[m]??s?.status,r=h(c);if(!i||!r)continue;const l=i.toUpperCase();(s?.id||s?.code)&&n.set(l,r),s?.name&&u.set(String(s.name).toUpperCase(),r)}return{byId:n,byName:u}}async function N(t){const e=C("assets/banlist.json");try{const n=await fetch(e,{signal:t});if(!n.ok)throw new Error(`HTTP ${n.status} for ${e}`);return await n.json()}catch{const n=await j(()=>import("./banlist-CKRXlV_A.js"),[]);return n.default??n}}function S(t="TCG"){const[e,n]=p.useState(()=>b),[u,m]=p.useState(()=>!b),[s,i]=p.useState(null);p.useEffect(()=>{if(b)return;const f=new AbortController;return(async()=>{try{m(!0),x||(x=(async()=>{const d=await N(f.signal);b=B(d,t)})()),await x,n(b),i(null)}catch(d){d?.name!=="AbortError"&&i(d)}finally{m(!1),x=null}})(),()=>f.abort()},[t]);const{legalById:c,legalByName:r}=p.useMemo(()=>({legalById:e?.byId??new Map,legalByName:e?.byName??new Map}),[e]),l=f=>{const g=String(f.id??"").toUpperCase(),d=String(f.name??"").toUpperCase();return c.get(g)??r.get(d)??null};return{legalById:c,legalByName:r,legalFor:l,withLegal:f=>f.map(g=>{const d=l(g);return d?{...g,legal:d}:g}),loading:u,error:s}}function y({title:t,items:e}){return a.jsxs("section",{className:"mb-8",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-3",children:[t," ",a.jsxs("span",{className:"text-sm text-neutral-400",children:["(",e.length,")"]})]}),a.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(n=>a.jsx(w,{card:n},n.id))})]})}function I(){const{cards:t,loading:e,error:n}=L(),{withLegal:u,loading:m,error:s}=S("TCG");if(e||m)return a.jsx("div",{children:"Loadingâ€¦"});if(n||s)return a.jsx("div",{className:"text-red-500",children:"Failed to load ban list."});const i=u(t),c=i.filter(o=>o.legal?.banned),r=i.filter(o=>o.legal?.limited&&!o.legal?.banned),l=i.filter(o=>o.legal?.semiLimited&&!o.legal?.limited&&!o.legal?.banned);return a.jsxs("div",{className:"grid gap-6",children:[a.jsx(y,{title:"Banned",items:c}),a.jsx(y,{title:"Limited",items:r}),a.jsx(y,{title:"Semi-Limited",items:l})]})}export{I as default};
