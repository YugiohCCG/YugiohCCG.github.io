import{b as l}from"./react-BJTGk-tB.js";import{a as j}from"./assets-BkOAQMwM.js";import{u as M,j as C}from"./index-CW3kYlzI.js";let d=null,c=null,u=null,m=null,g=null;async function h(s,e,n){const t=j(s);try{const a=await fetch(t,{signal:n});if(!a.ok)throw new Error(`HTTP ${a.status} for ${t}`);return await a.json()}catch{const a=await import(e);return a.default??a}}async function $(s){return h("assets/tcg/tcg-cards.json","../data/tcg-cards.json",s)}async function N(s){return h("assets/sets.json","../data/sets.json",s)}async function k(s){return h("assets/cards.json","../data/cards.json",s)}async function v(s){return h("assets/cards.test.json","../data/cards.test.json",s)}function O(s,e="CUSTOM-"){return s.map(n=>{const t=n.id?String(n.id):"",a=t&&t.startsWith(e)?t:`${e}${t||T()}`;return{...n,id:a}})}function P(s,e="TEST-"){return s.map(n=>{const t=n.id?String(n.id):"",a=t&&t.startsWith(e)?t:`${e}${t||T()}`;return{...n,id:a}})}function T(){return Math.random().toString(36).slice(2,10).toUpperCase()}function B(s={}){const{includeCustom:e=!0,includeTest:n=!1}=s,[t,a]=l.useState(()=>[...c??[],...u??[],...d??[]]),[f,b]=l.useState(()=>m??[]),[x,y]=l.useState(()=>!(d&&m&&(!e||c))),[E,w]=l.useState(null);l.useEffect(()=>{if(d&&m&&(!e||c)&&(!n||u))return;const o=new AbortController;return(async()=>{try{y(!0),g||(g=(async()=>{const[i,r]=await Promise.all([$(o.signal),N(o.signal)]);if(d=i,m=r,e&&!c)try{const p=await k(o.signal);c=O(p)}catch{c=[]}if(n&&!u)try{const p=await v(o.signal);u=P(p)}catch{u=[]}})()),await g,a([...e?c??[]:[],...n?u??[]:[],...d??[]]),b(m??[]),w(null)}catch(i){i?.name!=="AbortError"&&w(i)}finally{y(!1),g=null}})(),()=>o.abort()},[e,n]);const I=l.useMemo(()=>{const o=new Map(f.map(r=>[String(r.code),r])),S=new Map(t.map(r=>[String(r.id??r.code??r.name).toUpperCase(),r])),i=[...new Set(t.map(r=>r?.archetype).filter(Boolean))];return{setsByCode:o,archetypes:i,byId:S,setsList:f}},[t,f]);return{cards:t,sets:f,indexes:I,loading:x,error:E}}function L({card:s,imageHeight:e}){const{open:n}=M(),t=j(s.image);return C.jsx("div",{className:"card",children:C.jsx("div",{className:"w-full rounded-xl overflow-hidden cursor-zoom-in bg-neutral-900",style:e?{height:e}:{aspectRatio:"1 / 1.45965417867"},onClick:()=>n(t,s.name),title:"Click to enlarge",children:C.jsx("img",{src:t,alt:s.name,className:"w-full h-full object-contain object-center",loading:"lazy"})})})}export{L as C,B as u};
